// worker-bridge.ts
var worker = null;
var readyCallback = null;
(async () => {
  try {
    worker = new Worker(
      "/_content/SqliteWasmBlazor/sqlite-wasm-worker.js",
      { type: "module" }
    );
    worker.onmessage = async (event) => {
      if (event.data.type === "ready") {
        console.log("[Worker Bridge] Worker ready");
        if (readyCallback) {
          readyCallback();
        }
        return;
      }
      if (event.data.type === "error") {
        console.error("[Worker Bridge] Worker error:", event.data.error);
        return;
      }
      if (event.data.id !== void 0) {
        try {
          const exports = await globalThis.getDotnetRuntime(0).getAssemblyExports("SqliteWasmBlazor.dll");
          if (event.data.binary && event.data.data instanceof Uint8Array) {
            exports.SqliteWasmBlazor.SqliteWasmWorkerBridge.OnWorkerResponseBinary(
              event.data.id,
              event.data.data
            );
          } else {
            const messageJson = JSON.stringify(event.data);
            exports.SqliteWasmBlazor.SqliteWasmWorkerBridge.OnWorkerResponse(messageJson);
          }
        } catch (error) {
          console.error("[Worker Bridge] Failed to call C# callback:", error);
        }
      }
    };
    worker.onerror = (error) => {
      console.error("[Worker Bridge] Worker error event:", error);
    };
  } catch (error) {
    console.error("[Worker Bridge] Failed to create worker:", error);
  }
})();
function sendToWorker(messageJson) {
  if (!worker) {
    throw new Error("Worker not initialized");
  }
  const message = JSON.parse(messageJson);
  worker.postMessage(message);
}
function setReadyCallback(callback) {
  readyCallback = callback;
}
var logger = {
  setLogLevel(level) {
    if (!worker) {
      console.warn("[Worker Bridge] Worker not initialized, cannot set log level");
      return;
    }
    worker.postMessage({
      type: "setLogLevel",
      level
    });
  }
};
globalThis.sqliteWasmWorker = {
  sendToWorker,
  setReadyCallback
};
globalThis.__sqliteWasmLogger = logger;
export {
  logger,
  sendToWorker,
  setReadyCallback
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vVHlwZVNjcmlwdC93b3JrZXItYnJpZGdlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvLyB3b3JrZXItYnJpZGdlLnRzXG4vLyBCcmlkZ2UgYmV0d2VlbiBDIyBKU0ltcG9ydCBhbmQgV2ViIFdvcmtlclxuXG5sZXQgd29ya2VyOiBXb3JrZXIgfCBudWxsID0gbnVsbDtcbmxldCByZWFkeUNhbGxiYWNrOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcblxuLy8gSW5pdGlhbGl6ZSB3b3JrZXIgb24gZmlyc3QgaW1wb3J0XG4oYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIC8vIENyZWF0ZSB3b3JrZXIgLSBsb2FkIGZyb20gc3RhdGljIGFzc2V0cyBwYXRoXG4gICAgICAgIHdvcmtlciA9IG5ldyBXb3JrZXIoXG4gICAgICAgICAgICAnL19jb250ZW50L1NxbGl0ZVdhc21CbGF6b3Ivc3FsaXRlLXdhc20td29ya2VyLmpzJyxcbiAgICAgICAgICAgIHsgdHlwZTogJ21vZHVsZScgfVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEhhbmRsZSBtZXNzYWdlcyBmcm9tIHdvcmtlclxuICAgICAgICB3b3JrZXIub25tZXNzYWdlID0gYXN5bmMgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS50eXBlID09PSAncmVhZHknKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tXb3JrZXIgQnJpZGdlXSBXb3JrZXIgcmVhZHknKTtcbiAgICAgICAgICAgICAgICBpZiAocmVhZHlDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICByZWFkeUNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEudHlwZSA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tXb3JrZXIgQnJpZGdlXSBXb3JrZXIgZXJyb3I6JywgZXZlbnQuZGF0YS5lcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBGb3J3YXJkIHJlc3BvbnNlIHRvIEMjIHZpYSBKU0V4cG9ydCBtZXRob2RcbiAgICAgICAgICAgIGlmIChldmVudC5kYXRhLmlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBvcnRzID0gYXdhaXQgKGdsb2JhbFRoaXMgYXMgYW55KS5nZXREb3RuZXRSdW50aW1lKDApLmdldEFzc2VtYmx5RXhwb3J0cyhcIlNxbGl0ZVdhc21CbGF6b3IuZGxsXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGJpbmFyeSBNZXNzYWdlUGFjayBkYXRhXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5kYXRhLmJpbmFyeSAmJiBldmVudC5kYXRhLmRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBaZXJvLWNvcHkgYmluYXJ5IHBhdGg6IFVpbnQ4QXJyYXkgXHUyMTkyIFNwYW48Ynl0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuU3FsaXRlV2FzbUJsYXpvci5TcWxpdGVXYXNtV29ya2VyQnJpZGdlLk9uV29ya2VyUmVzcG9uc2VCaW5hcnkoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuZGF0YS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5kYXRhLmRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKU09OIGZhbGxiYWNrIGZvciBub24tZXhlY3V0ZSBvcGVyYXRpb25zIGFuZCBlcnJvcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VKc29uID0gSlNPTi5zdHJpbmdpZnkoZXZlbnQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBleHBvcnRzLlNxbGl0ZVdhc21CbGF6b3IuU3FsaXRlV2FzbVdvcmtlckJyaWRnZS5PbldvcmtlclJlc3BvbnNlKG1lc3NhZ2VKc29uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tXb3JrZXIgQnJpZGdlXSBGYWlsZWQgdG8gY2FsbCBDIyBjYWxsYmFjazonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHdvcmtlci5vbmVycm9yID0gKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbV29ya2VyIEJyaWRnZV0gV29ya2VyIGVycm9yIGV2ZW50OicsIGVycm9yKTtcbiAgICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tXb3JrZXIgQnJpZGdlXSBGYWlsZWQgdG8gY3JlYXRlIHdvcmtlcjonLCBlcnJvcik7XG4gICAgfVxufSkoKTtcblxuLy8gQ2FsbGVkIGZyb20gQyMgdG8gc2VuZCByZXF1ZXN0IHRvIHdvcmtlclxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRUb1dvcmtlcihtZXNzYWdlSnNvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCF3b3JrZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXb3JrZXIgbm90IGluaXRpYWxpemVkJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZUpzb24pO1xuICAgIHdvcmtlci5wb3N0TWVzc2FnZShtZXNzYWdlKTtcbn1cblxuLy8gQ2FsbGVkIGZyb20gQyMgdG8gc2V0IHJlYWR5IGNhbGxiYWNrXG5leHBvcnQgZnVuY3Rpb24gc2V0UmVhZHlDYWxsYmFjayhjYWxsYmFjazogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHJlYWR5Q2FsbGJhY2sgPSBjYWxsYmFjaztcbn1cblxuLy8gTG9nZ2VyIEFQSSAtIG1hdGNoZXMgQyMgU3FsaXRlV2FzbUxvZ0xldmVsIGVudW1cbmV4cG9ydCBjb25zdCBsb2dnZXIgPSB7XG4gICAgc2V0TG9nTGV2ZWwobGV2ZWw6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBpZiAoIXdvcmtlcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdbV29ya2VyIEJyaWRnZV0gV29ya2VyIG5vdCBpbml0aWFsaXplZCwgY2Fubm90IHNldCBsb2cgbGV2ZWwnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBTZW5kIGxvZyBsZXZlbCBjaGFuZ2UgdG8gd29ya2VyXG4gICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICB0eXBlOiAnc2V0TG9nTGV2ZWwnLFxuICAgICAgICAgICAgbGV2ZWw6IGxldmVsXG4gICAgICAgIH0pO1xuICAgIH1cbn07XG5cbi8vIE1ha2UgZnVuY3Rpb25zIGF2YWlsYWJsZSB0byBDIyBKU0ltcG9ydFxuKGdsb2JhbFRoaXMgYXMgYW55KS5zcWxpdGVXYXNtV29ya2VyID0ge1xuICAgIHNlbmRUb1dvcmtlcixcbiAgICBzZXRSZWFkeUNhbGxiYWNrXG59O1xuXG4vLyBFeHBvc2UgbG9nZ2VyIGZvciBDIyBKU0ltcG9ydFxuKGdsb2JhbFRoaXMgYXMgYW55KS5fX3NxbGl0ZVdhc21Mb2dnZXIgPSBsb2dnZXI7XG4iXSwKICAibWFwcGluZ3MiOiAiO0FBR0EsSUFBSSxTQUF3QjtBQUM1QixJQUFJLGdCQUFxQztBQUFBLENBR3hDLFlBQVk7QUFDVCxNQUFJO0FBRUEsYUFBUyxJQUFJO0FBQUEsTUFDVDtBQUFBLE1BQ0EsRUFBRSxNQUFNLFNBQVM7QUFBQSxJQUNyQjtBQUdBLFdBQU8sWUFBWSxPQUFPLFVBQVU7QUFDaEMsVUFBSSxNQUFNLEtBQUssU0FBUyxTQUFTO0FBQzdCLGdCQUFRLElBQUksOEJBQThCO0FBQzFDLFlBQUksZUFBZTtBQUNmLHdCQUFjO0FBQUEsUUFDbEI7QUFDQTtBQUFBLE1BQ0o7QUFFQSxVQUFJLE1BQU0sS0FBSyxTQUFTLFNBQVM7QUFDN0IsZ0JBQVEsTUFBTSxpQ0FBaUMsTUFBTSxLQUFLLEtBQUs7QUFDL0Q7QUFBQSxNQUNKO0FBR0EsVUFBSSxNQUFNLEtBQUssT0FBTyxRQUFXO0FBQzdCLFlBQUk7QUFDQSxnQkFBTSxVQUFVLE1BQU8sV0FBbUIsaUJBQWlCLENBQUMsRUFBRSxtQkFBbUIsc0JBQXNCO0FBR3ZHLGNBQUksTUFBTSxLQUFLLFVBQVUsTUFBTSxLQUFLLGdCQUFnQixZQUFZO0FBRTVELG9CQUFRLGlCQUFpQix1QkFBdUI7QUFBQSxjQUM1QyxNQUFNLEtBQUs7QUFBQSxjQUNYLE1BQU0sS0FBSztBQUFBLFlBQ2Y7QUFBQSxVQUNKLE9BQU87QUFFSCxrQkFBTSxjQUFjLEtBQUssVUFBVSxNQUFNLElBQUk7QUFDN0Msb0JBQVEsaUJBQWlCLHVCQUF1QixpQkFBaUIsV0FBVztBQUFBLFVBQ2hGO0FBQUEsUUFDSixTQUFTLE9BQU87QUFDWixrQkFBUSxNQUFNLCtDQUErQyxLQUFLO0FBQUEsUUFDdEU7QUFBQSxNQUNKO0FBQUEsSUFDSjtBQUVBLFdBQU8sVUFBVSxDQUFDLFVBQVU7QUFDeEIsY0FBUSxNQUFNLHVDQUF1QyxLQUFLO0FBQUEsSUFDOUQ7QUFBQSxFQUVKLFNBQVMsT0FBTztBQUNaLFlBQVEsTUFBTSw0Q0FBNEMsS0FBSztBQUFBLEVBQ25FO0FBQ0osR0FBRztBQUdJLFNBQVMsYUFBYSxhQUEyQjtBQUNwRCxNQUFJLENBQUMsUUFBUTtBQUNULFVBQU0sSUFBSSxNQUFNLHdCQUF3QjtBQUFBLEVBQzVDO0FBRUEsUUFBTSxVQUFVLEtBQUssTUFBTSxXQUFXO0FBQ3RDLFNBQU8sWUFBWSxPQUFPO0FBQzlCO0FBR08sU0FBUyxpQkFBaUIsVUFBNEI7QUFDekQsa0JBQWdCO0FBQ3BCO0FBR08sSUFBTSxTQUFTO0FBQUEsRUFDbEIsWUFBWSxPQUFxQjtBQUM3QixRQUFJLENBQUMsUUFBUTtBQUNULGNBQVEsS0FBSyw4REFBOEQ7QUFDM0U7QUFBQSxJQUNKO0FBRUEsV0FBTyxZQUFZO0FBQUEsTUFDZixNQUFNO0FBQUEsTUFDTjtBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFDSjtBQUdDLFdBQW1CLG1CQUFtQjtBQUFBLEVBQ25DO0FBQUEsRUFDQTtBQUNKO0FBR0MsV0FBbUIscUJBQXFCOyIsCiAgIm5hbWVzIjogW10KfQo=
